<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Forensics Application</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/select/1.7.0/css/select.bootstrap5.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/forensic-image-analysis.css" rel="stylesheet">
    <link href="css/premium.css" rel="stylesheet">
</head>

<body style="opacity: 0; transition: opacity 0.3s ease;">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-premium">
        <div class="container">
            <a class="navbar-brand fw-bold navbar-brand-premium" href="dashboard.html"><i
                    class="bi bi-shield-check me-2" style="color: #00d4ff;"></i> Digital Forensics</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="bi bi-house"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="toolsDropdown" role="button"
                            data-bs-toggle="dropdown">
                            <i class="bi bi-tools"></i> Tools
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="index.html">
                                    <i class="bi bi-shield-check"></i> File Integrity
                                </a></li>
                            <li><a class="dropdown-item" href="logs-and-notes.html">
                                    <i class="bi bi-clipboard-list"></i> Logs & Notes
                                </a></li>
                            <li><a class="dropdown-item" href="integrity-verification.html">
                                    <i class="bi bi-shield-alt"></i> Integrity Check
                                </a></li>
                            <li><a class="dropdown-item" href="auto-integrity-dashboard.html">
                                    <i class="bi bi-tachometer-alt"></i> Auto Integrity
                                </a></li>
                        </ul>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                            data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle"></i> <span id="navUserName">User</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="viewProfile()">
                                    <i class="bi bi-person"></i> Profile
                                </a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#" onclick="logout()">
                                    <i class="bi bi-box-arrow-right"></i> Logout
                                </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        </div>
    </nav>

    <!-- Floating Particles -->
    <div id="particles-container"></div>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page active">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-speedometer2"></i> Digital Forensics Dashboard</h2>
                    <p class="text-muted mb-4">Comprehensive forensic analysis and investigation tools</p>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="row mb-4">
                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-primary text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 id="total-cases">0</h4>
                                    <p class="mb-0">Active Cases</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="bi bi-folder2-open fs-2"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-success text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 id="recovered-files">0</h4>
                                    <p class="mb-0">Recovered Files</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="bi bi-arrow-clockwise fs-2"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="card stat-card bg-warning text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h4 id="images-analyzed">0</h4>
                                    <p class="mb-0">Images Analyzed</p>
                                </div>
                                <div class="align-self-center">
                                    <i class="bi bi-image fs-2"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


            </div>

            <!-- Forensic Modules -->
            <div class="row">
                <div class="col-12">
                    <h4 class="mb-4"><i class="bi bi-tools"></i> Forensic Analysis Modules</h4>
                </div>
            </div>

            <div class="row row-cols-1 row-cols-lg-2 g-4 justify-content-center">
                <!-- File Recovery Module -->
                <div class="col">
                    <div class="card module-card h-100 shadow-sm">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-arrow-clockwise"></i> File Recovery</h5>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <p class="card-text">Recover deleted files from various storage devices including hard
                                drives, USB drives, and memory cards.</p>
                            <div class="row mb-3">
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-hdd text-primary"></i>
                                        <span>Hard Drive Recovery</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-usb-drive text-primary"></i>
                                        <span>USB Recovery</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-sd-card text-primary"></i>
                                        <span>Memory Card Recovery</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-search text-primary"></i>
                                        <span>Deep Scan</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-auto">
                                <button class="btn btn-primary btn-lg w-100" onclick="navigateToPage('file-recovery')">
                                    <i class="bi bi-play-circle"></i> Start File Recovery
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Image Analysis Module -->
                <div class="col">
                    <div class="card module-card h-100 shadow-sm">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="bi bi-image"></i> Image Analysis</h5>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <p class="card-text">Advanced image forensics including metadata analysis, tampering
                                detection, and enhancement tools.</p>
                            <div class="row mb-3">
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-info-circle text-success"></i>
                                        <span>EXIF Data Analysis</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-shield-check text-success"></i>
                                        <span>Tampering Detection</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-brightness-high text-success"></i>
                                        <span>Image Enhancement</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="feature-item">
                                        <i class="bi bi-geo-alt text-success"></i>
                                        <span>GPS Location</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-auto">
                                <button class="btn btn-success btn-lg w-100" onclick="navigateToPage('image-analysis')">
                                    <i class="bi bi-camera"></i> Analyze Images
                                </button>
                            </div>
                        </div>
                    </div>
                </div>


            </div>

            <!-- Quick Actions -->
            <div class="row mt-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-lightning"></i> Quick Actions</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3 mb-2">
                                    <button class="btn btn-outline-primary w-100" onclick="createNewCase()">
                                        <i class="bi bi-plus-circle"></i> New Case
                                    </button>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <button class="btn btn-outline-success w-100" onclick="startFileRecovery()">
                                        <i class="bi bi-arrow-clockwise"></i> Quick Recovery
                                    </button>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <button class="btn btn-outline-warning w-100" onclick="generateReport()">
                                        <i class="bi bi-file-text"></i> Generate Report
                                    </button>
                                </div>
                                <div class="col-md-3 mb-2">
                                    <button class="btn btn-outline-info w-100" onclick="viewSystemStatus()">
                                        <i class="bi bi-gear"></i> System Status
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Recovery Page -->
        <div id="file-recovery-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-arrow-clockwise"></i> File Recovery - Recuva Professional</h2>
                    <p class="text-muted mb-4">Advanced file recovery tool for deleted and lost data recovery</p>
                </div>
            </div>

            <!-- Recovery Wizard -->\n <div class="row" id="recovery-wizard">
                <div class="col-md-4">
                    <div class="card recovery-wizard-card">
                        <div class="card-header bg-primary text-white">
                            <h5><i class="bi bi-1-circle"></i> Select Drive/Image</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="drive-selection" class="form-label">Select Drive or Load Image</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="source-type" id="drive-source"
                                        value="drive" checked>
                                    <label class="btn btn-outline-primary" for="drive-source">
                                        <i class="bi bi-hdd"></i> Drive
                                    </label>
                                    <input type="radio" class="btn-check" name="source-type" id="image-source"
                                        value="image">
                                    <label class="btn btn-outline-primary" for="image-source">
                                        <i class="bi bi-file-binary"></i> Image
                                    </label>
                                </div>
                            </div>

                            <!-- Drive Selection -->
                            <div id="drive-selection-panel">
                                <select class="form-select mb-3" id="drive-list">
                                    <option value="">Loading drives...</option>
                                </select>
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="refreshDrives()">
                                    <i class="bi bi-arrow-clockwise"></i> Refresh Drives
                                </button>
                            </div>

                            <!-- Image Selection -->
                            <div id="image-selection-panel" style="display: none;">
                                <input type="file" class="form-control mb-3" id="image-file"
                                    accept=".img,.dd,.raw,.iso,.vhd,.vmdk,.e01" multiple>
                                <div class="form-text">Supported: .img, .dd, .raw, .iso, .vhd, .vmdk, .e01</div>
                            </div>

                            <!-- Drive Info -->
                            <div id="drive-info" class="mt-3" style="display: none;">
                                <div class="card bg-light">
                                    <div class="card-body p-2">
                                        <small id="drive-details">Drive information will appear here</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card recovery-wizard-card">
                        <div class="card-header bg-success text-white">
                            <h5><i class="bi bi-2-circle"></i> Scan Options</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Scan Type</label>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="scan-type" id="quick-scan"
                                        value="quick" checked>
                                    <label class="form-check-label" for="quick-scan">
                                        <strong>Quick Scan</strong>
                                        <br><small class="text-muted">Fast scan for recently deleted files (~5-10
                                            min)</small>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="scan-type" id="deep-scan"
                                        value="deep">
                                    <label class="form-check-label" for="deep-scan">
                                        <strong>Deep Scan</strong>
                                        <br><small class="text-muted">Thorough scan for all recoverable files (~30-60
                                            min)</small>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="scan-type" id="deleted-recovery"
                                        value="deleted">
                                    <label class="form-check-label" for="deleted-recovery">
                                        <strong>Deleted File Recovery</strong>
                                        <br><small class="text-muted">Specialized scan for permanently deleted
                                            files</small>
                                    </label>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">File Types to Recover</label>
                                <div class="row">
                                    <div class="col-6">
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-images" checked>
                                            <label class="form-check-label" for="type-images">
                                                <i class="bi bi-image"></i> Images
                                            </label>
                                        </div>
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-documents" checked>
                                            <label class="form-check-label" for="type-documents">
                                                <i class="bi bi-file-text"></i> Documents
                                            </label>
                                        </div>
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-videos" checked>
                                            <label class="form-check-label" for="type-videos">
                                                <i class="bi bi-camera-video"></i> Videos
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-audio" checked>
                                            <label class="form-check-label" for="type-audio">
                                                <i class="bi bi-music-note"></i> Audio
                                            </label>
                                        </div>
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-archives" checked>
                                            <label class="form-check-label" for="type-archives">
                                                <i class="bi bi-file-zip"></i> Archives
                                            </label>
                                        </div>
                                        <div class="form-check form-check-sm">
                                            <input class="form-check-input" type="checkbox" id="type-all">
                                            <label class="form-check-label" for="type-all">
                                                <i class="bi bi-files"></i> All Files
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="min-file-size" class="form-label">Minimum File Size</label>
                                <select class="form-select form-select-sm" id="min-file-size">
                                    <option value="0">Any size</option>
                                    <option value="1024">1 KB</option>
                                    <option value="102400">100 KB</option>
                                    <option value="1048576">1 MB</option>
                                    <option value="10485760">10 MB</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="enable-carving" checked>
                                    <label class="form-check-label" for="enable-carving">
                                        <strong><i class="bi bi-scissors"></i> Enable File Carving</strong>
                                        <br><small class="text-muted">Advanced signature-based recovery for fragmented
                                            files</small>
                                    </label>
                                </div>
                                <div class="alert alert-info alert-sm mt-2" style="font-size: 0.8rem;">
                                    <i class="bi bi-info-circle"></i>
                                    <strong>File Carving:</strong> Recovers files using magic number signatures (JPEG:
                                    FF D8 FF, PNG: 89 50 4E 47, PDF: %PDF-, etc.) even when file system metadata is
                                    damaged.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card recovery-wizard-card">
                        <div class="card-header bg-warning text-dark">
                            <h5><i class="bi bi-3-circle"></i> Start Recovery</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label class="form-label">Recovery Summary</label>
                                <div class="card bg-light">
                                    <div class="card-body p-2">
                                        <small>
                                            <strong>Source:</strong> <span id="summary-source">No drive
                                                selected</span><br>
                                            <strong>Scan Type:</strong> <span id="summary-scan-type">Quick
                                                Scan</span><br>
                                            <strong>File Types:</strong> <span id="summary-file-types">5 types
                                                selected</span><br>
                                            <strong>Est. Time:</strong> <span id="summary-time">5-10 minutes</span>
                                        </small>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="output-folder" class="form-label">Recovery Output Folder</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="output-folder"
                                        value="C:\\Recovered_Files" readonly>
                                    <button class="btn btn-outline-secondary" onclick="selectOutputFolder()">
                                        <i class="bi bi-folder"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="d-grid gap-2">
                                <button class="btn btn-success btn-lg" onclick="startComprehensiveRecovery()"
                                    id="start-recovery-btn">
                                    <i class="bi bi-play-fill"></i> Start Recovery Scan
                                </button>
                                <button class="btn btn-outline-info" onclick="startComprehensiveScan()"
                                    id="comprehensive-scan-btn">
                                    <i class="bi bi-scissors"></i> Comprehensive Scan with Carving
                                </button>
                                <button class="btn btn-outline-secondary" onclick="resetWizard()">
                                    <i class="bi bi-arrow-clockwise"></i> Reset
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recovery Progress -->
            <div class="row mt-4" id="recovery-progress" style="display: none;">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                            <h5><i class="bi bi-hourglass-split"></i> Recovery in Progress</h5>
                            <button class="btn btn-outline-light btn-sm" onclick="pauseRecovery()" id="pause-btn">
                                <i class="bi bi-pause-fill"></i> Pause
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="mb-3">
                                        <div class="d-flex justify-content-between">
                                            <span>Overall Progress</span>
                                            <span id="progress-percentage">0%</span>
                                        </div>
                                        <div class="progress mb-2">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                id="progress-bar" role="progressbar" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div class="row text-center">
                                        <div class="col-3">
                                            <div class="fs-4 text-success" id="files-found">0</div>
                                            <small class="text-muted">Files Found</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="fs-4 text-info" id="files-recoverable">0</div>
                                            <small class="text-muted">Recoverable</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="fs-4 text-warning" id="current-sector">0</div>
                                            <small class="text-muted">Current Sector</small>
                                        </div>
                                        <div class="col-3">
                                            <div class="fs-4 text-primary" id="elapsed-time">00:00</div>
                                            <small class="text-muted">Elapsed</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card bg-light">
                                        <div class="card-header p-2">
                                            <small><strong>Current Activity</strong></small>
                                        </div>
                                        <div class="card-body p-2">
                                            <div id="current-activity" class="small">
                                                Initializing scan...
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-2">
                                        <button class="btn btn-danger btn-sm w-100" onclick="stopRecovery()">
                                            <i class="bi bi-stop-fill"></i> Stop Recovery
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recovery Results -->
            <div class="row mt-4" id="recovery-results-section" style="display: none;">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5><i class="bi bi-files"></i> Recovery Results</h5>
                            <div>
                                <button class="btn btn-success btn-sm me-2" onclick="recoverSelectedFiles()">
                                    <i class="bi bi-download"></i> Recover Selected
                                </button>
                                <button class="btn btn-outline-primary btn-sm me-2" onclick="exportResults()">
                                    <i class="bi bi-file-earmark-excel"></i> Export List
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="newScan()">
                                    <i class="bi bi-arrow-repeat"></i> New Scan
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" id="results-search"
                                            placeholder="Search recovered files...">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select" id="results-filter">
                                        <option value="all">All Files</option>
                                        <option value="excellent">Excellent Recovery</option>
                                        <option value="good">Good Recovery</option>
                                        <option value="poor">Poor Recovery</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check mt-2">
                                        <input class="form-check-input" type="checkbox" id="select-all-files">
                                        <label class="form-check-label" for="select-all-files">
                                            Select All (<span id="total-files-count">0</span>)
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Recovery Statistics -->
                            <div class="row mb-4">
                                <div class="col-md-3">
                                    <div class="stat-card bg-primary text-white">
                                        <div class="stat-number" id="total-files-stat">0</div>
                                        <div class="stat-label">Total Files Found</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card bg-success text-white">
                                        <div class="stat-number" id="excellent-recovery-stat">0</div>
                                        <div class="stat-label">Excellent Recovery</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card bg-warning text-white">
                                        <div class="stat-number" id="good-recovery-stat">0</div>
                                        <div class="stat-label">Good Recovery</div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="stat-card bg-danger text-white">
                                        <div class="stat-number" id="poor-recovery-stat">0</div>
                                        <div class="stat-label">Poor Recovery</div>
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="table table-hover" id="recovered-files-table">
                                    <thead>
                                        <tr>
                                            <th width="30">
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox"
                                                        id="select-all-checkbox">
                                                </div>
                                            </th>
                                            <th><i class="bi bi-file-text me-1"></i>Filename</th>
                                            <th><i class="bi bi-folder me-1"></i>Path</th>
                                            <th><i class="bi bi-hdd me-1"></i>Size</th>
                                            <th><i class="bi bi-file-earmark me-1"></i>Type</th>
                                            <th><i class="bi bi-calendar me-1"></i>Modified</th>
                                            <th><i class="bi bi-graph-up me-1"></i>Recovery Probability</th>
                                            <th><i class="bi bi-info-circle me-1"></i>Status</th>
                                            <th><i class="bi bi-gear me-1"></i>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="results-tbody">
                                        <tr>
                                            <td colspan="8" class="text-center text-muted py-4">
                                                No recovery results to display
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <div>
                                    <small class="text-muted">Showing <span id="showing-count">0</span> of <span
                                            id="total-results">0</span> files</small>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0" id="results-pagination">
                                        <!-- Pagination will be generated here -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Forensic Image Analysis Page -->
        <div id="image-analysis-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-image"></i> Forensic Image Analysis</h2>
                    <p class="text-muted mb-4">Advanced forensic tools for image authentication and manipulation
                        detection</p>
                </div>
            </div>

            <!-- Analysis Tools Tabs -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <ul class="nav nav-tabs card-header-tabs" id="forensic-tabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="upload-tab" data-bs-toggle="tab"
                                        data-bs-target="#upload-panel" type="button" role="tab">
                                        <i class="bi bi-upload"></i> Upload Image
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="metadata-tab" data-bs-toggle="tab"
                                        data-bs-target="#metadata-panel" type="button" role="tab">
                                        <i class="bi bi-info-circle"></i> Metadata Viewer
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="ela-tab" data-bs-toggle="tab"
                                        data-bs-target="#ela-panel" type="button" role="tab">
                                        <i class="bi bi-graph-up"></i> Error Level Analysis
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="noise-tab" data-bs-toggle="tab"
                                        data-bs-target="#noise-panel" type="button" role="tab">
                                        <i class="bi bi-activity"></i> Noise Analysis
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="clone-tab" data-bs-toggle="tab"
                                        data-bs-target="#clone-panel" type="button" role="tab">
                                        <i class="bi bi-layers"></i> Clone Detection
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="pixel-tab" data-bs-toggle="tab"
                                        data-bs-target="#pixel-panel" type="button" role="tab">
                                        <i class="bi bi-zoom-in"></i> Pixel Examination
                                    </button>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body">
                            <div class="tab-content" id="forensic-tab-content">
                                <!-- Upload Panel -->
                                <div class="tab-pane fade show active" id="upload-panel" role="tabpanel">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h5><i class="bi bi-upload"></i> Upload Image for Analysis</h5>
                                            <p class="text-muted">Upload an image file to perform comprehensive forensic
                                                analysis</p>

                                            <form id="forensic-upload-form" enctype="multipart/form-data">
                                                <div class="mb-3">
                                                    <div class="upload-area" id="forensic-upload-area">
                                                        <i class="bi bi-cloud-arrow-up fs-1 text-muted"></i>
                                                        <p>Drag and drop an image here or click to browse</p>
                                                        <input type="file" class="form-control d-none"
                                                            id="forensic-image-file"
                                                            accept=".jpg,.jpeg,.png,.tiff,.tif,.bmp,.gif" required>
                                                        <button type="button" class="btn btn-outline-primary"
                                                            onclick="document.getElementById('forensic-image-file').click()">
                                                            Choose Image File
                                                        </button>
                                                    </div>
                                                    <div class="form-text">Supported formats: JPEG, PNG, TIFF, BMP, GIF
                                                        (Max: 16MB)</div>
                                                </div>

                                                <!-- Image Preview -->
                                                <div id="forensic-image-preview" class="mb-3" style="display: none;">
                                                    <img id="forensic-preview-img" class="img-fluid rounded border"
                                                        style="max-height: 200px;">
                                                    <div class="mt-2" id="forensic-image-info">
                                                        <!-- Image info will be populated here -->
                                                    </div>
                                                </div>

                                                <div class="mb-3">
                                                    <label class="form-label">Analysis Types</label>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-metadata" checked>
                                                                <label class="form-check-label" for="analysis-metadata">
                                                                    <i class="bi bi-info-circle text-primary"></i>
                                                                    Metadata Extraction
                                                                </label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-ela" checked>
                                                                <label class="form-check-label" for="analysis-ela">
                                                                    <i class="bi bi-graph-up text-success"></i> Error
                                                                    Level Analysis
                                                                </label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-noise" checked>
                                                                <label class="form-check-label" for="analysis-noise">
                                                                    <i class="bi bi-activity text-warning"></i> Noise
                                                                    Analysis
                                                                </label>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6">
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-clone" checked>
                                                                <label class="form-check-label" for="analysis-clone">
                                                                    <i class="bi bi-layers text-danger"></i> Clone
                                                                    Detection
                                                                </label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-pixel" checked>
                                                                <label class="form-check-label" for="analysis-pixel">
                                                                    <i class="bi bi-zoom-in text-info"></i> Pixel
                                                                    Examination
                                                                </label>
                                                            </div>
                                                            <div class="form-check">
                                                                <input class="form-check-input" type="checkbox"
                                                                    id="analysis-quality" checked>
                                                                <label class="form-check-label" for="analysis-quality">
                                                                    <i class="bi bi-star text-secondary"></i> Quality
                                                                    Assessment
                                                                </label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <button type="submit" class="btn btn-primary btn-lg"
                                                    id="start-forensic-analysis">
                                                    <i class="bi bi-search"></i> Start Forensic Analysis
                                                </button>
                                            </form>

                                            <!-- Analysis Progress -->
                                            <div id="forensic-analysis-progress" style="display: none;" class="mt-4">
                                                <div class="d-flex align-items-center mb-2">
                                                    <div class="spinner-border spinner-border-sm me-2" role="status">
                                                    </div>
                                                    <span id="analysis-status-text">Performing forensic
                                                        analysis...</span>
                                                </div>
                                                <div class="progress">
                                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                                        role="progressbar" style="width: 0%" id="analysis-progress-bar">
                                                    </div>
                                                </div>
                                                <small class="text-muted" id="analysis-detail-text">Initializing
                                                    analysis...</small>
                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <h5><i class="bi bi-info-circle"></i> Analysis Overview</h5>
                                            <p class="text-muted">Our comprehensive forensic analysis includes:</p>

                                            <div class="accordion" id="analysis-info-accordion">
                                                <div class="accordion-item">
                                                    <h6 class="accordion-header">
                                                        <button class="accordion-button collapsed" type="button"
                                                            data-bs-toggle="collapse" data-bs-target="#metadata-info">
                                                            <i class="bi bi-info-circle text-primary me-2"></i> Metadata
                                                            Extraction
                                                        </button>
                                                    </h6>
                                                    <div id="metadata-info" class="accordion-collapse collapse"
                                                        data-bs-parent="#analysis-info-accordion">
                                                        <div class="accordion-body">
                                                            Extract comprehensive metadata including EXIF, IPTC, XMP
                                                            data, GPS coordinates, camera information, software details,
                                                            and timestamps.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="accordion-item">
                                                    <h6 class="accordion-header">
                                                        <button class="accordion-button collapsed" type="button"
                                                            data-bs-toggle="collapse" data-bs-target="#ela-info">
                                                            <i class="bi bi-graph-up text-success me-2"></i> Error Level
                                                            Analysis
                                                        </button>
                                                    </h6>
                                                    <div id="ela-info" class="accordion-collapse collapse"
                                                        data-bs-parent="#analysis-info-accordion">
                                                        <div class="accordion-body">
                                                            Detect image manipulation by analyzing JPEG compression
                                                            error levels. Manipulated areas typically show different
                                                            error patterns than original content.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="accordion-item">
                                                    <h6 class="accordion-header">
                                                        <button class="accordion-button collapsed" type="button"
                                                            data-bs-toggle="collapse" data-bs-target="#noise-info">
                                                            <i class="bi bi-activity text-warning me-2"></i> Noise
                                                            Analysis
                                                        </button>
                                                    </h6>
                                                    <div id="noise-info" class="accordion-collapse collapse"
                                                        data-bs-parent="#analysis-info-accordion">
                                                        <div class="accordion-body">
                                                            Analyze noise patterns to identify manipulated regions.
                                                            Natural images have consistent noise characteristics that
                                                            change when edited.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="accordion-item">
                                                    <h6 class="accordion-header">
                                                        <button class="accordion-button collapsed" type="button"
                                                            data-bs-toggle="collapse" data-bs-target="#clone-info">
                                                            <i class="bi bi-layers text-danger me-2"></i> Clone
                                                            Detection
                                                        </button>
                                                    </h6>
                                                    <div id="clone-info" class="accordion-collapse collapse"
                                                        data-bs-parent="#analysis-info-accordion">
                                                        <div class="accordion-body">
                                                            Detect copied/cloned regions using advanced feature matching
                                                            and block matching algorithms to identify duplicated
                                                            content.
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="accordion-item">
                                                    <h6 class="accordion-header">
                                                        <button class="accordion-button collapsed" type="button"
                                                            data-bs-toggle="collapse" data-bs-target="#pixel-info">
                                                            <i class="bi bi-zoom-in text-info me-2"></i> Pixel
                                                            Examination
                                                        </button>
                                                    </h6>
                                                    <div id="pixel-info" class="accordion-collapse collapse"
                                                        data-bs-parent="#analysis-info-accordion">
                                                        <div class="accordion-body">
                                                            Detailed pixel-level analysis including color distribution,
                                                            edge detection, texture analysis, and anomaly detection.
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Metadata Panel -->
                                <div class="tab-pane fade" id="metadata-panel" role="tabpanel">
                                    <div id="metadata-results">
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i> Upload an image to view comprehensive
                                            metadata analysis results.
                                        </div>
                                    </div>
                                </div>

                                <!-- ELA Panel -->
                                <div class="tab-pane fade" id="ela-panel" role="tabpanel">
                                    <div id="ela-results">
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i> Upload an image to view Error Level
                                            Analysis results and manipulation detection.
                                        </div>
                                    </div>
                                </div>

                                <!-- Noise Panel -->
                                <div class="tab-pane fade" id="noise-panel" role="tabpanel">
                                    <div id="noise-results">
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i> Upload an image to view noise pattern
                                            analysis and consistency evaluation.
                                        </div>
                                    </div>
                                </div>

                                <!-- Clone Panel -->
                                <div class="tab-pane fade" id="clone-panel" role="tabpanel">
                                    <div id="clone-results">
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i> Upload an image to perform clone detection
                                            and copy-paste analysis.
                                        </div>
                                    </div>
                                </div>

                                <!-- Pixel Panel -->
                                <div class="tab-pane fade" id="pixel-panel" role="tabpanel">
                                    <div id="pixel-results">
                                        <div class="alert alert-info">
                                            <i class="bi bi-info-circle"></i> Upload an image to perform detailed
                                            pixel-level examination and analysis.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analysis Summary Dashboard -->
            <div class="row" id="analysis-summary-dashboard" style="display: none;">
                <div class="col-12">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-clipboard-data"></i> Forensic Analysis Summary</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="text-center">
                                        <div class="forensic-score-circle" id="authenticity-score">85</div>
                                        <h6 class="mt-2">Authenticity Score</h6>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="text-center">
                                        <div class="forensic-indicator" id="manipulation-likelihood">LOW</div>
                                        <h6 class="mt-2">Manipulation Risk</h6>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6>Key Findings</h6>
                                    <ul id="key-findings-list" class="list-unstyled">
                                        <!-- Key findings will be populated here -->
                                    </ul>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <button class="btn btn-success me-2" id="export-analysis-btn">
                                        <i class="bi bi-download"></i> Export Full Report
                                    </button>
                                    <button class="btn btn-primary me-2" id="new-analysis-btn">
                                        <i class="bi bi-plus-circle"></i> New Analysis
                                    </button>
                                    <button class="btn btn-outline-secondary" id="view-sessions-btn">
                                        <i class="bi bi-list"></i> View All Sessions
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs and Reports Page -->
        <div id="logs-reports-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-file-text"></i> Logs and Reports</h2>
                    <p class="text-muted mb-4">View system logs and generate forensic reports</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-funnel"></i> Filter Options</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="logType" class="form-label">Log Type</label>
                                <select class="form-select" id="logType">
                                    <option value="all">All Logs</option>
                                    <option value="system">System Logs</option>
                                    <option value="recovery">Recovery Logs</option>
                                    <option value="analysis">Analysis Logs</option>
                                    <option value="case">Case Logs</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="dateRange" class="form-label">Date Range</label>
                                <select class="form-select" id="dateRange">
                                    <option value="today">Today</option>
                                    <option value="week">Last 7 Days</option>
                                    <option value="month">Last 30 Days</option>
                                    <option value="all">All Time</option>
                                </select>
                            </div>
                            <button class="btn btn-primary w-100 mb-2" onclick="filterLogs()">
                                <i class="bi bi-funnel"></i> Apply Filter
                            </button>
                            <button class="btn btn-success w-100" onclick="generateFullReport()">
                                <i class="bi bi-file-earmark-pdf"></i> Generate Report
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between">
                            <h5><i class="bi bi-journal-text"></i> Activity Logs</h5>
                            <button class="btn btn-outline-secondary btn-sm" onclick="refreshLogs()">
                                <i class="bi bi-arrow-clockwise"></i> Refresh
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="logsContainer">
                                <div class="log-entry">
                                    <div class="d-flex justify-content-between">
                                        <span class="log-time">2025-11-18 10:30:15</span>
                                        <span class="badge bg-info">SYSTEM</span>
                                    </div>
                                    <div class="log-message">Application started successfully</div>
                                </div>
                                <div class="log-entry">
                                    <div class="d-flex justify-content-between">
                                        <span class="log-time">2025-11-18 10:31:22</span>
                                        <span class="badge bg-success">RECOVERY</span>
                                    </div>
                                    <div class="log-message">File recovery scan initiated on drive C:</div>
                                </div>
                                <div class="log-entry">
                                    <div class="d-flex justify-content-between">
                                        <span class="log-time">2025-11-18 10:35:45</span>
                                        <span class="badge bg-warning">ANALYSIS</span>
                                    </div>
                                    <div class="log-message">Image analysis completed: IMG_001.jpg</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Upload Page -->
        <div id="upload-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-cloud-arrow-up"></i> Upload Evidence</h2>
                    <hr>
                </div>
            </div>

            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5>Upload New Evidence</h5>
                        </div>
                        <div class="card-body">
                            <form id="upload-form" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <label for="evidence-file" class="form-label">Select Evidence File</label>
                                    <input type="file" class="form-control" id="evidence-file" required>
                                    <div class="form-text">Supported formats: Images, Documents, Archives, Disk Images
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="case-name" class="form-label">Case Name</label>
                                    <input type="text" class="form-control" id="case-name"
                                        placeholder="Enter case name">
                                </div>

                                <div class="mb-3">
                                    <label for="description" class="form-label">Description</label>
                                    <textarea class="form-control" id="description" rows="3"
                                        placeholder="Brief description of the evidence"></textarea>
                                </div>

                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-upload"></i> Upload and Analyze
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header">
                            <h5>Upload Guidelines</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-unstyled">
                                <li><i class="bi bi-check-circle text-success"></i> Maximum file size: 100MB</li>
                                <li><i class="bi bi-check-circle text-success"></i> Multiple formats supported</li>
                                <li><i class="bi bi-check-circle text-success"></i> Automatic hash calculation</li>
                                <li><i class="bi bi-check-circle text-success"></i> Secure file handling</li>
                                <li><i class="bi bi-info-circle text-info"></i> Files are analyzed automatically</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Page -->
        <div id="analysis-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-search"></i> Analysis Results</h2>
                    <hr>
                </div>
            </div>

            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5>Analysis Results</h5>
                            <button class="btn btn-outline-primary btn-sm" onclick="refreshAnalysis()">
                                <i class="bi bi-arrow-clockwise"></i> Refresh
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="analysis-results">
                                <p class="text-muted">No analysis results available</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cases Page -->
        <div id="cases-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-briefcase"></i> Case Management</h2>
                    <p class="text-muted mb-4">Create, manage, and track forensic investigation cases</p>
                </div>
            </div>

            <!-- Case Statistics -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card bg-primary text-white">
                        <div class="card-body text-center">
                            <h3 id="total-cases-stat">0</h3>
                            <p class="mb-0">Total Cases</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-success text-white">
                        <div class="card-body text-center">
                            <h3 id="active-cases-stat">0</h3>
                            <p class="mb-0">Active Cases</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-warning text-white">
                        <div class="card-body text-center">
                            <h3 id="pending-cases-stat">0</h3>
                            <p class="mb-0">Pending Review</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-info text-white">
                        <div class="card-body text-center">
                            <h3 id="evidence-files-stat">0</h3>
                            <p class="mb-0">Evidence Files</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Case Management Tools -->
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5><i class="bi bi-list"></i> Case List</h5>
                            <div>
                                <button class="btn btn-outline-secondary btn-sm me-2" onclick="refreshCases()">
                                    <i class="bi bi-arrow-clockwise"></i> Refresh
                                </button>
                                <button class="btn btn-primary btn-sm" data-bs-toggle="modal"
                                    data-bs-target="#newCaseModal">
                                    <i class="bi bi-plus-circle"></i> New Case
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="cases-list">
                                <div class="text-center py-4">
                                    <i class="bi bi-folder2-open fs-1 text-muted"></i>
                                    <p class="text-muted mt-2">No cases found. Create your first case to get started.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h5><i class="bi bi-funnel"></i> Filter Cases</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="case-status-filter" class="form-label">Status</label>
                                <select class="form-select" id="case-status-filter">
                                    <option value="all">All Status</option>
                                    <option value="open">Open</option>
                                    <option value="in-progress">In Progress</option>
                                    <option value="pending-review">Pending Review</option>
                                    <option value="closed">Closed</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="case-priority-filter" class="form-label">Priority</label>
                                <select class="form-select" id="case-priority-filter">
                                    <option value="all">All Priorities</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                            <button class="btn btn-primary w-100" onclick="filterCases()">
                                <i class="bi bi-funnel"></i> Apply Filters
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-lightning"></i> Quick Actions</h5>
                        </div>
                        <div class="card-body">
                            <button class="btn btn-outline-primary w-100 mb-2" onclick="bulkExport()">
                                <i class="bi bi-download"></i> Export Cases
                            </button>
                            <button class="btn btn-outline-success w-100 mb-2" onclick="generateCaseReport()">
                                <i class="bi bi-file-earmark-pdf"></i> Generate Report
                            </button>
                            <button class="btn btn-outline-info w-100" onclick="viewCaseStatistics()">
                                <i class="bi bi-graph-up"></i> View Statistics
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Page -->
        <div id="tools-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-tools"></i> Forensic Tools</h2>
                    <hr>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-hash"></i> Hash Calculator</h5>
                        </div>
                        <div class="card-body">
                            <p>Calculate MD5, SHA1, and SHA256 hashes for files</p>
                            <input type="file" class="form-control mb-3" id="hash-file">
                            <button class="btn btn-primary" onclick="calculateHash()">Calculate Hash</button>
                            <div id="hash-results" class="mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6 mb-3">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="bi bi-file-text"></i> File Info</h5>
                        </div>
                        <div class="card-body">
                            <p>Get detailed file information and metadata</p>
                            <input type="file" class="form-control mb-3" id="info-file">
                            <button class="btn btn-primary" onclick="getFileInfo()">Get Info</button>
                            <div id="info-results" class="mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- New Case Modal -->
    <div class="modal fade" id="newCaseModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title"><i class="bi bi-plus-circle"></i> Create New Forensic Case</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="new-case-form" enctype="multipart/form-data">
                        <!-- Basic Case Information -->
                        <div class="row">
                            <div class="col-md-8">
                                <div class="mb-3">
                                    <label for="modal-case-name" class="form-label">Case Name *</label>
                                    <input type="text" class="form-control" id="modal-case-name" required
                                        placeholder="Enter case name...">
                                    <div class="form-text">Use a descriptive name for easy identification</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="modal-case-id" class="form-label">Case ID</label>
                                    <input type="text" class="form-control" id="modal-case-id" readonly
                                        placeholder="Auto-generated">
                                    <div class="form-text">Automatically generated</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modal-investigator" class="form-label">Lead Investigator *</label>
                                    <input type="text" class="form-control" id="modal-investigator" required
                                        placeholder="Enter investigator name...">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modal-department" class="form-label">Department/Agency</label>
                                    <input type="text" class="form-control" id="modal-department"
                                        placeholder="Enter department...">
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="modal-priority" class="form-label">Priority Level</label>
                                    <select class="form-select" id="modal-priority">
                                        <option value="medium">Medium</option>
                                        <option value="high">High</option>
                                        <option value="low">Low</option>
                                        <option value="critical">Critical</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="modal-case-type" class="form-label">Case Type</label>
                                    <select class="form-select" id="modal-case-type">
                                        <option value="criminal">Criminal Investigation</option>
                                        <option value="civil">Civil Investigation</option>
                                        <option value="corporate">Corporate Investigation</option>
                                        <option value="incident-response">Incident Response</option>
                                        <option value="data-recovery">Data Recovery</option>
                                        <option value="malware-analysis">Malware Analysis</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="modal-incident-date" class="form-label">Incident Date</label>
                                    <input type="date" class="form-control" id="modal-incident-date">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="modal-case-description" class="form-label">Case Description</label>
                            <textarea class="form-control" id="modal-case-description" rows="4"
                                placeholder="Provide detailed description of the case..."></textarea>
                        </div>

                        <div class="mb-3">
                            <label for="modal-location" class="form-label">Incident Location</label>
                            <input type="text" class="form-control" id="modal-location"
                                placeholder="Enter location where incident occurred...">
                        </div>

                        <!-- Evidence Upload Section -->
                        <hr>
                        <h6><i class="bi bi-upload"></i> Initial Evidence Upload</h6>
                        <div class="mb-3">
                            <label for="modal-evidence-files" class="form-label">Evidence Files</label>
                            <input type="file" class="form-control" id="modal-evidence-files" multiple
                                accept=".img,.dd,.raw,.iso,.vhd,.vmdk,.jpg,.jpeg,.png,.pdf,.doc,.docx,.zip,.rar,.7z">
                            <div class="form-text">Select disk images, documents, or other evidence files (Max 500MB per
                                file)</div>
                        </div>

                        <div class="mb-3">
                            <label for="modal-evidence-description" class="form-label">Evidence Description</label>
                            <textarea class="form-control" id="modal-evidence-description" rows="2"
                                placeholder="Describe the evidence being uploaded..."></textarea>
                        </div>

                        <!-- Chain of Custody -->
                        <hr>
                        <h6><i class="bi bi-shield-check"></i> Chain of Custody</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modal-seized-by" class="form-label">Evidence Seized By</label>
                                    <input type="text" class="form-control" id="modal-seized-by"
                                        placeholder="Name of person who seized evidence...">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="modal-seizure-date" class="form-label">Seizure Date/Time</label>
                                    <input type="datetime-local" class="form-control" id="modal-seizure-date">
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="modal-custody-notes" class="form-label">Chain of Custody Notes</label>
                            <textarea class="form-control" id="modal-custody-notes" rows="2"
                                placeholder="Document evidence handling, storage conditions, etc..."></textarea>
                        </div>

                        <!-- Case Team -->
                        <hr>
                        <h6><i class="bi bi-people"></i> Case Team</h6>
                        <div class="mb-3">
                            <label for="modal-team-members" class="form-label">Additional Team Members</label>
                            <textarea class="form-control" id="modal-team-members" rows="2"
                                placeholder="List additional investigators, analysts, or support staff (one per line)..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancel
                    </button>
                    <button type="button" class="btn btn-primary" onclick="createCase()">
                        <i class="bi bi-plus-circle"></i> Create Case
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Case Details Modal -->
    <div class="modal fade" id="caseDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="caseDetailsTitle">Case Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="caseDetailsContent">
                        <!-- Case details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="editCaseBtn">Edit Case</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Evidence Upload Modal -->
    <div class="modal fade" id="evidenceUploadModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="bi bi-upload"></i> Upload Evidence</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="evidence-upload-form" enctype="multipart/form-data">
                        <input type="hidden" id="evidence-case-id">

                        <div class="mb-3">
                            <label for="evidence-files" class="form-label">Select Evidence Files *</label>
                            <input type="file" class="form-control" id="evidence-files" multiple required>
                            <div class="form-text">Supported: Disk images (.img, .dd, .raw), Documents (.pdf, .doc),
                                Archives (.zip, .rar), Images (.jpg, .png)</div>
                        </div>

                        <div class="mb-3">
                            <label for="evidence-type" class="form-label">Evidence Type</label>
                            <select class="form-select" id="evidence-type">
                                <option value="disk-image">Disk Image</option>
                                <option value="document">Document</option>
                                <option value="image">Image/Photo</option>
                                <option value="archive">Archive File</option>
                                <option value="log-file">Log File</option>
                                <option value="memory-dump">Memory Dump</option>
                                <option value="network-capture">Network Capture</option>
                                <option value="other">Other</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="evidence-source" class="form-label">Evidence Source</label>
                            <input type="text" class="form-control" id="evidence-source"
                                placeholder="e.g., Suspect's laptop, Server backup, etc.">
                        </div>

                        <div class="mb-3">
                            <label for="evidence-description-upload" class="form-label">Description</label>
                            <textarea class="form-control" id="evidence-description-upload" rows="3"
                                placeholder="Describe the evidence and its relevance to the case..."></textarea>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="evidence-collected-by" class="form-label">Collected By</label>
                                    <input type="text" class="form-control" id="evidence-collected-by">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="evidence-collection-date" class="form-label">Collection Date</label>
                                    <input type="datetime-local" class="form-control" id="evidence-collection-date">
                                </div>
                            </div>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="auto-analyze">
                            <label class="form-check-label" for="auto-analyze">
                                Automatically analyze files after upload
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-success" onclick="uploadEvidence()">
                        <i class="bi bi-upload"></i> Upload Evidence
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div class="modal fade" id="file-preview-modal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="preview-modal-title">File Preview</h5>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-primary btn-sm"
                            id="preview-mode-content">Content</button>
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="preview-mode-hex">Hex
                            View</button>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0" id="file-preview-content">
                    <div class="text-center p-4" id="preview-loading">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Loading preview...</p>
                    </div>
                    <div id="preview-error" class="alert alert-danger m-3" style="display: none;">
                        <strong>Preview Error:</strong> <span id="preview-error-message"></span>
                    </div>
                    <div id="preview-container" style="display: none;">
                        <!-- Image preview -->
                        <div id="image-preview" class="text-center p-3" style="display: none;">
                            <img id="preview-image" class="img-fluid" style="max-height: 70vh;" />
                        </div>
                        <!-- Text preview -->
                        <div id="text-preview" style="display: none;">
                            <pre id="preview-text" class="p-3"
                                style="max-height: 70vh; overflow-y: auto; white-space: pre-wrap; font-family: 'Courier New', monospace;"></pre>
                        </div>
                        <!-- PDF preview -->
                        <div id="pdf-preview" style="display: none;">
                            <iframe id="preview-pdf" width="100%" height="600px" frameborder="0"></iframe>
                        </div>
                        <!-- Hex preview -->
                        <div id="hex-preview" style="display: none;">
                            <div class="p-3">
                                <div class="row mb-2">
                                    <div class="col">
                                        <small class="text-muted">Showing first 16KB - Offset | Hex Values |
                                            ASCII</small>
                                    </div>
                                </div>
                                <pre id="preview-hex"
                                    style="font-family: 'Courier New', monospace; font-size: 0.875rem; max-height: 70vh; overflow-y: auto;"></pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="me-auto">
                        <small class="text-muted" id="preview-file-info"></small>
                    </div>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="preview-recover-btn">Recover File</button>
                </div>
            </div>
        </div>

        <!-- EXIF Metadata Extraction Page -->
        <div id="exif-metadata-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-info-square"></i> EXIF Metadata Extraction</h2>
                    <p class="text-muted mb-4">Extract comprehensive metadata from digital images for forensic analysis
                    </p>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-upload"></i> Upload Image for Metadata Extraction</h5>
                        </div>
                        <div class="card-body">
                            <form id="exif-upload-form" enctype="multipart/form-data">
                                <div class="mb-3">
                                    <div class="upload-area" id="exif-upload-area">
                                        <i class="bi bi-cloud-arrow-up fs-1 text-muted"></i>
                                        <p>Drag and drop an image here or click to browse</p>
                                        <input type="file" class="form-control d-none" id="exif-image-file"
                                            accept=".jpg,.jpeg,.png,.tiff,.tif,.bmp,.gif" required>
                                        <button type="button" class="btn btn-outline-primary"
                                            onclick="document.getElementById('exif-image-file').click()">
                                            Choose Image File
                                        </button>
                                    </div>
                                    <div class="form-text">Supported formats: JPEG, PNG, TIFF, BMP, GIF (Max: 16MB)
                                    </div>
                                </div>

                                <!-- Image Preview -->
                                <div id="exif-image-preview" class="mb-3" style="display: none;">
                                    <img id="exif-preview-img" class="img-fluid rounded border"
                                        style="max-height: 150px;">
                                    <div class="mt-2" id="exif-image-info">
                                        <!-- Image info will be populated here -->
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label">Extraction Type</label>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="extractionType"
                                            id="full-extraction" value="full" checked>
                                        <label class="form-check-label" for="full-extraction">
                                            <i class="bi bi-list-ul text-primary"></i> <strong>Comprehensive
                                                Analysis</strong>
                                            <small class="d-block text-muted">Extract all available metadata with
                                                forensic analysis</small>
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="extractionType"
                                            id="summary-extraction" value="summary">
                                        <label class="form-check-label" for="summary-extraction">
                                            <i class="bi bi-speedometer2 text-success"></i> <strong>Quick
                                                Summary</strong>
                                            <small class="d-block text-muted">Extract key metadata fields only</small>
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="extractionType"
                                            id="gps-extraction" value="gps">
                                        <label class="form-check-label" for="gps-extraction">
                                            <i class="bi bi-geo-alt text-danger"></i> <strong>GPS Location
                                                Focus</strong>
                                            <small class="d-block text-muted">Focus on location and GPS data
                                                extraction</small>
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="extractionType"
                                            id="camera-extraction" value="camera">
                                        <label class="form-check-label" for="camera-extraction">
                                            <i class="bi bi-camera text-warning"></i> <strong>Camera
                                                Information</strong>
                                            <small class="d-block text-muted">Extract camera, lens, and capture
                                                settings</small>
                                        </label>
                                    </div>
                                </div>

                                <button type="submit" class="btn btn-primary btn-lg w-100" id="start-exif-extraction">
                                    <i class="bi bi-search"></i> Extract Metadata
                                </button>
                            </form>

                            <!-- Analysis Progress -->
                            <div id="exif-analysis-progress" style="display: none;" class="mt-4">
                                <div class="d-flex align-items-center mb-2">
                                    <div class="spinner-border spinner-border-sm me-2" role="status"></div>
                                    <span id="exif-status-text">Extracting metadata...</span>
                                </div>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated"
                                        role="progressbar" style="width: 0%" id="exif-progress-bar"></div>
                                </div>
                                <small class="text-muted" id="exif-detail-text">Processing image...</small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card border-info">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="bi bi-info-circle"></i> About EXIF Metadata</h5>
                        </div>
                        <div class="card-body">
                            <p>EXIF (Exchangeable Image File Format) metadata contains valuable information embedded in
                                digital images:</p>

                            <div class="accordion" id="exif-info-accordion">
                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#camera-info-acc">
                                            <i class="bi bi-camera text-primary me-2"></i> Camera Information
                                        </button>
                                    </h6>
                                    <div id="camera-info-acc" class="accordion-collapse collapse"
                                        data-bs-parent="#exif-info-accordion">
                                        <div class="accordion-body">
                                            Camera make and model, serial numbers, lens information, and capture
                                            settings like ISO, aperture, and shutter speed.
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#location-info-acc">
                                            <i class="bi bi-geo-alt text-success me-2"></i> GPS Location Data
                                        </button>
                                    </h6>
                                    <div id="location-info-acc" class="accordion-collapse collapse"
                                        data-bs-parent="#exif-info-accordion">
                                        <div class="accordion-body">
                                            GPS coordinates, altitude, direction, and timestamp when the photo was
                                            taken, if location services were enabled.
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#timestamp-info-acc">
                                            <i class="bi bi-clock text-warning me-2"></i> Timestamp Information
                                        </button>
                                    </h6>
                                    <div id="timestamp-info-acc" class="accordion-collapse collapse"
                                        data-bs-parent="#exif-info-accordion">
                                        <div class="accordion-body">
                                            Original capture time, file modification dates, and timezone information
                                            critical for forensic timeline analysis.
                                        </div>
                                    </div>
                                </div>

                                <div class="accordion-item">
                                    <h6 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                            data-bs-toggle="collapse" data-bs-target="#software-info-acc">
                                            <i class="bi bi-gear text-danger me-2"></i> Software Details
                                        </button>
                                    </h6>
                                    <div id="software-info-acc" class="accordion-collapse collapse"
                                        data-bs-parent="#exif-info-accordion">
                                        <div class="accordion-body">
                                            Image editing software used, processing applications, and modification
                                            history that can indicate tampering.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="alert alert-warning mt-3">
                                <i class="bi bi-exclamation-triangle"></i>
                                <strong>Forensic Note:</strong> EXIF data can be modified or stripped. Always
                                cross-reference with other evidence sources.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div class="row" id="exif-results-section" style="display: none;">
                <div class="col-12">
                    <div class="card border-success">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="bi bi-check-circle"></i> Metadata Extraction Results</h5>
                        </div>
                        <div class="card-body">
                            <!-- Navigation Tabs for Results -->
                            <ul class="nav nav-tabs" id="exif-results-tabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="summary-tab" data-bs-toggle="tab"
                                        data-bs-target="#summary-panel" type="button" role="tab">
                                        <i class="bi bi-speedometer2"></i> Summary
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="camera-tab" data-bs-toggle="tab"
                                        data-bs-target="#camera-panel" type="button" role="tab">
                                        <i class="bi bi-camera"></i> Camera Info
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="location-tab" data-bs-toggle="tab"
                                        data-bs-target="#location-panel" type="button" role="tab">
                                        <i class="bi bi-geo-alt"></i> Location
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="technical-tab" data-bs-toggle="tab"
                                        data-bs-target="#technical-panel" type="button" role="tab">
                                        <i class="bi bi-gear"></i> Technical
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="forensic-tab" data-bs-toggle="tab"
                                        data-bs-target="#forensic-panel" type="button" role="tab">
                                        <i class="bi bi-shield-check"></i> Forensic Analysis
                                    </button>
                                </li>
                            </ul>

                            <div class="tab-content mt-3" id="exif-results-content">
                                <!-- Summary Panel -->
                                <div class="tab-pane fade show active" id="summary-panel" role="tabpanel">
                                    <div id="metadata-summary-content">
                                        <!-- Summary content will be populated here -->
                                    </div>
                                </div>

                                <!-- Camera Panel -->
                                <div class="tab-pane fade" id="camera-panel" role="tabpanel">
                                    <div id="camera-info-content">
                                        <!-- Camera info content will be populated here -->
                                    </div>
                                </div>

                                <!-- Location Panel -->
                                <div class="tab-pane fade" id="location-panel" role="tabpanel">
                                    <div id="location-info-content">
                                        <!-- Location content will be populated here -->
                                    </div>
                                </div>

                                <!-- Technical Panel -->
                                <div class="tab-pane fade" id="technical-panel" role="tabpanel">
                                    <div id="technical-info-content">
                                        <!-- Technical content will be populated here -->
                                    </div>
                                </div>

                                <!-- Forensic Panel -->
                                <div class="tab-pane fade" id="forensic-panel" role="tabpanel">
                                    <div id="forensic-analysis-content">
                                        <!-- Forensic analysis content will be populated here -->
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="row mt-4">
                                <div class="col-12">
                                    <button class="btn btn-success me-2" id="export-metadata-btn">
                                        <i class="bi bi-download"></i> Export Metadata Report
                                    </button>
                                    <button class="btn btn-primary me-2" id="new-metadata-analysis-btn">
                                        <i class="bi bi-plus-circle"></i> Analyze New Image
                                    </button>
                                    <button class="btn btn-outline-secondary" id="copy-metadata-btn">
                                        <i class="bi bi-clipboard"></i> Copy to Clipboard
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ELA Analysis Page -->
        <div id="ela-analysis-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-search"></i> Error Level Analysis (ELA)</h2>
                    <p class="text-muted mb-4">Detect image tampering through JPEG compression artifact analysis</p>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-upload"></i> Upload Image for ELA Analysis</h5>
                        </div>
                        <div class="card-body" id="ela-container">
                            <!-- Upload Area -->
                            <div class="upload-area" id="ela-upload-area">
                                <div class="upload-content">
                                    <i class="bi bi-search-plus upload-icon"></i>
                                    <div class="upload-text">Drop image here or click to select file for ELA analysis
                                    </div>
                                    <div class="upload-hint">Supports JPG, PNG, BMP, TIFF, GIF formats</div>
                                </div>
                                <input type="file" id="ela-file-input" accept="image/*" style="display: none;">
                                <input type="file" id="ela-batch-file-input" accept="image/*" multiple
                                    style="display: none;">
                            </div>

                            <!-- File Info Display -->
                            <div id="ela-file-info" class="mt-3"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="card border-secondary">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0"><i class="bi bi-gear"></i> Analysis Options</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="ela-analysis-type" class="form-label">Analysis Type</label>
                                <select class="form-select" id="ela-analysis-type">
                                    <option value="single">Single Image Analysis</option>
                                    <option value="multi-quality">Multi-Quality Analysis</option>
                                    <option value="quick">Quick Tampering Scan</option>
                                    <option value="batch">Batch Analysis</option>
                                    <option value="regions">Region-Focused Analysis</option>
                                </select>
                            </div>

                            <!-- Quality Controls -->
                            <div id="ela-quality-controls" class="mb-3">
                                <label for="ela-quality-slider" class="form-label">
                                    JPEG Quality: <span id="ela-quality-value">95</span>
                                </label>
                                <input type="range" class="form-range" id="ela-quality-slider" min="1" max="100"
                                    value="95">
                                <div class="form-text">Higher quality = more sensitive detection</div>
                            </div>

                            <!-- Multi-Quality Controls -->
                            <div id="ela-multi-quality-controls" class="mb-3" style="display: none;">
                                <label for="ela-quality-levels" class="form-label">Quality Levels</label>
                                <input type="text" class="form-control" id="ela-quality-levels"
                                    placeholder="95,90,85,80,75" value="95,90,85,80,75">
                                <div class="form-text">Comma-separated quality levels</div>
                            </div>

                            <button class="btn btn-primary w-100" id="ela-analyze-btn" disabled>
                                <i class="bi bi-play-fill"></i> Start ELA Analysis
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Bar -->
            <div id="ela-progress-container" class="progress-container mb-4" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span id="ela-progress-text">Processing...</span>
                    <span class="text-muted">Please wait</span>
                </div>
                <div class="progress">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" id="ela-progress-bar"
                        role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
            </div>

            <!-- Results Container -->
            <div id="ela-results-container" class="results-container" style="display: none;">
                <div class="row">
                    <div class="col-12">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0"><i class="bi bi-check-circle"></i> ELA Analysis Results</h5>
                            </div>
                            <div class="card-body">
                                <div id="ela-results-content">
                                    <!-- Results will be populated here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clone & Noise Detection Page -->
        <div id="clone-noise-detection-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-copy"></i> Clone & Noise Detection</h2>
                    <p class="text-muted mb-4">Advanced tampering detection using multiple algorithms including
                        copy-move detection, block matching, noise analysis, and statistical anomaly detection</p>
                </div>
            </div>

            <!-- Analysis Configuration -->
            <div class="row mb-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-gear"></i> Analysis Configuration</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="clone-noise-analysis-type" class="form-label">Analysis Type</label>
                                    <select class="form-select" id="clone-noise-analysis-type">
                                        <option value="comprehensive">Comprehensive Analysis (All Methods)</option>
                                        <option value="copy-move">Copy-Move Detection Only</option>
                                        <option value="noise">Noise Consistency Analysis</option>
                                        <option value="block-matching">Block Matching Analysis</option>
                                        <option value="statistical">Statistical Anomaly Detection</option>
                                        <option value="batch">Batch Analysis (Multiple Files)</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Quick Info</label>
                                    <div class="alert alert-info py-2 mb-0">
                                        <small><i class="bi bi-info-circle"></i> Comprehensive analysis provides the
                                            most thorough tampering detection.</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Detection Methods Selection -->
                            <div id="clone-noise-methods-container" class="mt-4">
                                <h6>Detection Methods <small class="text-muted">(for comprehensive analysis)</small>
                                </h6>
                                <div class="row" id="clone-noise-methods">
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="detection-method"
                                                value="copy_move" id="method-copy-move" checked>
                                            <label class="form-check-label" for="method-copy-move">
                                                <i class="bi bi-copy text-primary"></i> Copy-Move Detection
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="detection-method"
                                                value="block_matching" id="method-block-matching" checked>
                                            <label class="form-check-label" for="method-block-matching">
                                                <i class="bi bi-grid text-info"></i> Block Matching
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="detection-method"
                                                value="noise_analysis" id="method-noise-analysis" checked>
                                            <label class="form-check-label" for="method-noise-analysis">
                                                <i class="bi bi-graph-up text-warning"></i> Noise Analysis
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" name="detection-method"
                                                value="statistical_analysis" id="method-statistical" checked>
                                            <label class="form-check-label" for="method-statistical">
                                                <i class="bi bi-bar-chart text-success"></i> Statistical Analysis
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-info-circle"></i> Method Information</h5>
                        </div>
                        <div class="card-body">
                            <div class="small">
                                <p><strong>Copy-Move:</strong> Detects identical regions using SIFT/ORB features</p>
                                <p><strong>Block Matching:</strong> Analyzes block similarities using correlation</p>
                                <p><strong>Noise Analysis:</strong> Examines noise patterns for inconsistencies</p>
                                <p><strong>Statistical:</strong> Detects anomalies in statistical properties</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- File Upload -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-upload"></i> Upload Image for Tampering Analysis</h5>
                        </div>
                        <div class="card-body">
                            <div class="upload-area" id="clone-noise-upload-area">
                                <div class="upload-icon">
                                    <i class="bi bi-cloud-upload"></i>
                                </div>
                                <div class="upload-text">Drop image here or click to select file for tampering analysis
                                </div>
                                <div class="upload-hint">Supported formats: JPEG, PNG, BMP, TIFF, GIF (Max 10MB)</div>
                            </div>

                            <!-- Hidden file inputs -->
                            <input type="file" id="clone-noise-file-input" accept=".jpg,.jpeg,.png,.bmp,.tiff,.gif"
                                style="display: none;">
                            <input type="file" id="clone-noise-batch-file-input"
                                accept=".jpg,.jpeg,.png,.bmp,.tiff,.gif" multiple style="display: none;">

                            <!-- File info -->
                            <div id="clone-noise-file-info" class="mt-3"></div>

                            <!-- Analyze Button -->
                            <div class="text-center mt-3">
                                <button id="clone-noise-analyze-btn" class="btn btn-primary btn-lg" disabled>
                                    <i class="bi bi-play-fill"></i> Start Tampering Analysis
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Indicator -->
            <div id="clone-noise-progress-container" class="progress-container mb-4" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span id="clone-noise-progress-text">Processing...</span>
                    <span class="text-muted">Please wait</span>
                </div>
                <div class="progress">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" id="clone-noise-progress-bar"
                        role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
            </div>

            <!-- Results Container -->
            <div id="clone-noise-results-container" class="results-container" style="display: none;">
                <div class="row">
                    <div class="col-12">
                        <div class="card border-primary">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0"><i class="bi bi-check-circle"></i> Clone & Noise Detection Results</h5>
                            </div>
                            <div class="card-body">
                                <div id="clone-noise-results-content">
                                    <!-- Results will be populated here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Hex Viewer & Byte Inspector Page -->
        <div id="hex-viewer-page" class="page">
            <div class="row">
                <div class="col-12">
                    <h2><i class="bi bi-file-binary"></i> Hex Viewer & Byte-Level Inspector</h2>
                    <p class="text-muted mb-4">Advanced binary file analysis for detecting low-level manipulations and
                        file signatures</p>
                </div>
            </div>

            <!-- Analysis Type Selection -->
            <div class="row mb-4">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-gear"></i> Analysis Configuration</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="hex-analysis-type" class="form-label">Analysis Type</label>
                                    <select class="form-select" id="hex-analysis-type">
                                        <option value="analysis">Binary Analysis & Hex Dump</option>
                                        <option value="search">Pattern Search</option>
                                        <option value="compare">File Comparison</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Analysis Features</label>
                                    <div class="alert alert-info py-2 mb-0">
                                        <small><i class="bi bi-info-circle"></i> Comprehensive binary analysis with
                                            signature detection and anomaly identification.</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="bi bi-info-circle"></i> Features</h5>
                        </div>
                        <div class="card-body">
                            <div class="small">
                                <p><strong>Hex Dump:</strong> Interactive binary display with ASCII</p>
                                <p><strong>Signatures:</strong> Automatic file type detection</p>
                                <p><strong>Search:</strong> Find hex patterns or ASCII strings</p>
                                <p><strong>Compare:</strong> Byte-level file differences</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Binary Analysis Section -->
            <div id="hex-analysis-section" class="analysis-section">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-upload"></i> Upload File for Binary Analysis</h5>
                            </div>
                            <div class="card-body">
                                <div class="upload-area" id="hex-viewer-upload-area">
                                    <div class="upload-icon">
                                        <i class="bi bi-cloud-upload"></i>
                                    </div>
                                    <div class="upload-text">Drop file here or click to select for hex analysis</div>
                                    <div class="upload-hint">All file types supported - Max 50MB</div>
                                </div>

                                <input type="file" id="hex-viewer-file-input" style="display: none;">

                                <!-- File info -->
                                <div id="hex-file-info" class="mt-3"></div>

                                <!-- Analyze Button -->
                                <div class="text-center mt-3">
                                    <button id="hex-analyze-btn" class="btn btn-dark btn-lg" disabled>
                                        <i class="bi bi-play-fill"></i> Start Binary Analysis
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pattern Search Section -->
            <div id="hex-search-section" class="analysis-section" style="display: none;">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-search"></i> Pattern Search</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="hex-search-pattern" class="form-label">Search Pattern</label>
                                        <input type="text" class="form-control" id="hex-search-pattern"
                                            placeholder="Enter hex pattern (e.g., FF D8 FF) or ASCII text">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="hex-search-type" class="form-label">Pattern Type</label>
                                        <select class="form-select" id="hex-search-type">
                                            <option value="hex">Hex Pattern</option>
                                            <option value="ascii">ASCII Text</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">&nbsp;</label>
                                        <div>
                                            <button id="hex-search-btn" class="btn btn-warning" disabled>
                                                <i class="bi bi-search"></i> Search Pattern
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-3">
                                    <div class="alert alert-info">
                                        <strong>Examples:</strong><br>
                                        <strong>Hex:</strong> FF D8 FF (JPEG), 89 50 4E 47 (PNG)<br>
                                        <strong>ASCII:</strong> password, admin, config, secret
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- File Comparison Section -->
            <div id="hex-compare-section" class="analysis-section" style="display: none;">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0"><i class="bi bi-files"></i> Binary File Comparison</h5>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-5">
                                        <label class="form-label">First File</label>
                                        <div class="border p-3 text-center bg-light" style="cursor: pointer;"
                                            onclick="document.getElementById('hex-compare-file1-input').click()">
                                            <i class="bi bi-file-earmark fa-2x text-muted mb-2"></i>
                                            <div>Click to select first file</div>
                                        </div>
                                        <input type="file" id="hex-compare-file1-input" style="display: none;">
                                        <div id="hex-compare-file1-info" class="mt-2"></div>
                                    </div>

                                    <div class="col-md-2 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-arrow-left-right fa-2x text-muted"></i>
                                    </div>

                                    <div class="col-md-5">
                                        <label class="form-label">Second File</label>
                                        <div class="border p-3 text-center bg-light" style="cursor: pointer;"
                                            onclick="document.getElementById('hex-compare-file2-input').click()">
                                            <i class="bi bi-file-earmark fa-2x text-muted mb-2"></i>
                                            <div>Click to select second file</div>
                                        </div>
                                        <input type="file" id="hex-compare-file2-input" style="display: none;">
                                        <div id="hex-compare-file2-info" class="mt-2"></div>
                                    </div>
                                </div>

                                <div class="text-center mt-4">
                                    <button id="hex-compare-btn" class="btn btn-success btn-lg" disabled>
                                        <i class="bi bi-files"></i> Compare Files
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Indicator -->
            <div id="hex-progress-container" class="progress-container mb-4" style="display: none;">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span id="hex-progress-text">Processing...</span>
                    <span class="text-muted">Please wait</span>
                </div>
                <div class="progress">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" id="hex-progress-bar"
                        role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    </div>
                </div>
            </div>

            <!-- Results Container -->
            <div id="hex-results-container" class="results-container" style="display: none;">
                <div class="row">
                    <div class="col-12">
                        <div class="card border-dark">
                            <div class="card-header bg-dark text-white">
                                <h5 class="mb-0"><i class="bi bi-check-circle"></i> Hex Analysis Results</h5>
                            </div>
                            <div class="card-body">
                                <div id="hex-results-content">
                                    <!-- Results will be populated here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery (required for DataTables) -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.7.0/js/dataTables.select.min.js"></script>
    <!-- Authentication JS -->
    <script src="js/auth.js"></script>

    <!-- Custom JS -->
    <script src="js/app.js"></script>
    <script src="js/forensic-image-analysis.js"></script>
    <script src="js/exif-metadata-extractor.js"></script>
    <script src="js/ela-analyzer.js"></script>
    <script src="js/clone-noise-detector.js"></script>
    <script src="js/hex-viewer.js"></script>
    <script src="js/integrity-manager.js"></script>

    <!-- Authentication and Navigation Script -->
    <script>
        let authManager;

        // Initialize authentication on page load
        document.addEventListener('DOMContentLoaded', async function () {
            // Show loading state
            document.body.style.opacity = '0.7';
            
            authManager = new AuthManager();

            // Check if user is authenticated
            if (!authManager.isAuthenticated()) {
                window.location.href = '/';
                return;
            }
            
            // Validate token
            const isValid = await authManager.validateToken();
            if (!isValid) {
                window.location.href = '/';
                return;
            }

            // Check if user has minimum required role (Viewer)
            try {
                const response = await authManager.authenticatedFetch('/api/auth/profile');
                if (response.ok) {
                    const profile = await response.json();

                    // Update navigation with user info
                    document.getElementById('navUserName').textContent = profile.full_name || profile.username;
                    
                    // Remove loading state
                    document.body.style.opacity = '1';

                    // Check role permissions
                    const roleHierarchy = { 'Viewer': 1, 'Forensic Investigator': 2, 'Admin': 3 };
                    const userLevel = roleHierarchy[profile.role] || 0;

                    if (userLevel < 1) { // Less than Viewer
                        alert('Access denied. You need at least Viewer role to access this page.');
                        authManager.logout();
                        return;
                    }
                    
                    // Load dashboard statistics
                    loadDashboardStats();

                    // Modify UI based on role permissions
                    if (userLevel < 2) { // Less than Forensic Investigator
                        // Hide advanced features that require Forensic Investigator role
                        const investigatorFeatures = document.querySelectorAll('[data-min-role="Forensic Investigator"]');
                        investigatorFeatures.forEach(element => {
                            element.style.display = 'none';
                        });
                    }

                } else {
                    throw new Error('Failed to load profile');
                }
            } catch (error) {
                console.error('Authentication error:', error);
                authManager.logout();
            }
        });

        // Logout function
        function logout() {
            if (authManager) {
                authManager.logout();
            }
        }

        // Profile view function
        function viewProfile() {
            // You can implement a profile modal or redirect to profile page
            alert('Profile management will be available in the next update.');
        }

        // Navigation function for module pages
        function navigateToPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show target page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
            } else {
                // If page doesn't exist, show appropriate content or redirect
                switch(pageId) {
                    case 'file-recovery':
                        showFileRecoveryModule();
                        break;
                    case 'image-analysis':
                        showImageAnalysisModule();
                        break;

                    default:
                        // Return to dashboard
                        document.getElementById('dashboard-page').classList.add('active');
                }
            }
        }

        // Show File Recovery Module
        function showFileRecoveryModule() {
            alert('File Recovery module will be integrated in the next update. This will include advanced file recovery tools and deep scanning capabilities.');
        }

        // Show Image Analysis Module
        function showImageAnalysisModule() {
            alert('Image Analysis module is coming soon! This will include EXIF data analysis, tampering detection, and forensic image enhancement tools.');
        }

        // Show Case Management Module
        function showCaseManagementModule() {
            alert('Case Management system will be available soon. This will help you organize investigations, manage evidence, and track case progress.');
        }

        // Quick Action Functions
        async function createNewCase() {
            const caseName = prompt('Enter case name:');
            if (!caseName) return;
            
            const description = prompt('Enter case description (optional):') || '';
            
            try {
                const response = await fetch('/api/forensic/cases', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${authManager.getToken()}`
                    },
                    body: JSON.stringify({
                        name: caseName,
                        description: description,
                        status: 'active'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    alert(` Case "${caseName}" created successfully! Case ID: ${result.case_id}`);
                    // Refresh stats
                    loadDashboardStats();
                } else {
                    const error = await response.json();
                    alert(` Failed to create case: ${error.error || 'Unknown error'}`);
                }
            } catch (error) {
                console.error('Error creating case:', error);
                alert(' Error creating case. Please try again.');
            }
        }

        async function startFileRecovery() {
            // Create modal for file recovery options
            const modal = document.createElement('div');
            modal.innerHTML = `
                <div class="modal fade" id="recoveryModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title"><i class="bi bi-arrow-clockwise"></i> Quick File Recovery</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <p>Choose recovery method:</p>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="startDeepScan()"> Deep Disk Scan</button>
                                    <button class="btn btn-success" onclick="showFileCarving()"> File Carving</button>
                                    <button class="btn btn-info" onclick="showIntegrityCheck()"> Integrity Verification</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            const bootstrapModal = new bootstrap.Modal(document.getElementById('recoveryModal'));
            bootstrapModal.show();
            
            // Clean up modal after hiding
            document.getElementById('recoveryModal').addEventListener('hidden.bs.modal', () => {
                document.body.removeChild(modal);
            });
        }

        function startDeepScan() {
            // Close modal and show deep scan options
            bootstrap.Modal.getInstance(document.getElementById('recoveryModal')).hide();
            alert(' Deep Disk Scan will analyze storage devices for recoverable files.\n\nNote: This feature requires administrator privileges and can take significant time.');
            // You could redirect to a dedicated deep scan page here
        }

        function showFileCarving() {
            bootstrap.Modal.getInstance(document.getElementById('recoveryModal')).hide();
            alert(' File Carving extracts files from raw data blocks.\n\nThis advanced feature will be available in the File Recovery module.');
        }

        function showIntegrityCheck() {
            bootstrap.Modal.getInstance(document.getElementById('recoveryModal')).hide();
            window.location.href = 'integrity-verification.html';
        }

        async function generateReport() {
            // Show report generation options
            const reportType = prompt('Select report type:\n\n1. Investigation Log\n2. System Status\n3. Case Summary\n4. Analysis Results\n\nEnter number (1-4):');
            
            switch(reportType) {
                case '1':
                    window.location.href = 'logs-and-notes.html';
                    break;
                case '2':
                    await generateSystemStatusReport();
                    break;
                case '3':
                    await generateCaseSummary();
                    break;
                case '4':
                    window.location.href = 'logs-and-notes.html#analysis-results';
                    break;
                default:
                    window.location.href = 'logs-and-notes.html';
            }
        }

        async function generateSystemStatusReport() {
            try {
                // Gather system information
                const healthResponse = await fetch('/api/health');
                const health = await healthResponse.json();
                
                const report = `
# System Status Report
## Generated: ${new Date().toLocaleString()}

### System Health
- Status: ${health.status || 'Unknown'}
- Timestamp: ${health.timestamp || 'N/A'}

### Authentication System
- Status:  Active
- User: ${document.getElementById('navUserName').textContent}

### Available Modules
-  File Integrity Verification
-  Logs and Notes
-  Auto Integrity Monitoring
-  User Management
-  Hex Viewer

### Quick Actions
-  Case Management
-  File Recovery Tools
-  Report Generation
-  System Monitoring
                `;
                
                // Create and download report
                const blob = new Blob([report], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `system-status-${new Date().toISOString().split('T')[0]}.md`;
                a.click();
                URL.revokeObjectURL(url);
                
                alert(' System Status Report generated and downloaded!');
            } catch (error) {
                console.error('Error generating report:', error);
                alert(' Error generating system status report.');
            }
        }

        async function generateCaseSummary() {
            try {
                const response = await fetch('/api/forensic/cases', {
                    headers: {
                        'Authorization': `Bearer ${authManager.getToken()}`
                    }
                });
                
                if (response.ok) {
                    const cases = await response.json();
                    const activeCases = cases.filter(c => c.status === 'active');
                    const completedCases = cases.filter(c => c.status === 'completed');
                    
                    const report = `
# Case Summary Report
## Generated: ${new Date().toLocaleString()}

### Statistics
- Total Cases: ${cases.length}
- Active Cases: ${activeCases.length}
- Completed Cases: ${completedCases.length}

### Active Cases
${activeCases.map(c => `- **${c.name}**: ${c.description || 'No description'} (Created: ${c.created_at})`).join('\n') || 'No active cases'}

### Recent Activity
${cases.slice(0, 5).map(c => `- ${c.name} - ${c.status} (${c.created_at})`).join('\n') || 'No recent activity'}
                    `;
                    
                    const blob = new Blob([report], { type: 'text/markdown' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `case-summary-${new Date().toISOString().split('T')[0]}.md`;
                    a.click();
                    URL.revokeObjectURL(url);
                    
                    alert(' Case Summary Report generated and downloaded!');
                } else {
                    alert(' Unable to fetch case data for report.');
                }
            } catch (error) {
                console.error('Error generating case summary:', error);
                alert(' Error generating case summary report.');
            }
        }

        async function viewSystemStatus() {
            try {
                // Create a detailed system status modal
                const modal = document.createElement('div');
                modal.innerHTML = `
                    <div class="modal fade" id="systemStatusModal" tabindex="-1">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title"><i class="bi bi-gear"></i> System Status Dashboard</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <div id="systemStatusContent">
                                        <div class="text-center">
                                            <div class="spinner-border" role="status"></div>
                                            <p class="mt-2">Loading system status...</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                    <button type="button" class="btn btn-primary" onclick="refreshSystemStatus()"> Refresh</button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                const bootstrapModal = new bootstrap.Modal(document.getElementById('systemStatusModal'));
                bootstrapModal.show();
                
                // Load system status
                await loadSystemStatus();
                
                // Clean up modal after hiding
                document.getElementById('systemStatusModal').addEventListener('hidden.bs.modal', () => {
                    document.body.removeChild(modal);
                });
            } catch (error) {
                console.error('Error showing system status:', error);
                alert(' Error loading system status.');
            }
        }

        async function loadSystemStatus() {
            try {
                const healthResponse = await fetch('/api/health');
                const health = await healthResponse.json();
                
                const currentUser = document.getElementById('navUserName').textContent;
                const uptime = new Date().toLocaleString();
                
                const statusHtml = `
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"> System Health</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>Status:</strong> <span class="badge bg-success">Online</span></p>
                                    <p><strong>Last Check:</strong> ${uptime}</p>
                                    <p><strong>Response Time:</strong> <span class="text-success">Fast</span></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-info">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"> Authentication</h6>
                                </div>
                                <div class="card-body">
                                    <p><strong>Current User:</strong> ${currentUser}</p>
                                    <p><strong>Session Status:</strong> <span class="badge bg-success">Active</span></p>
                                    <p><strong>Security:</strong> <span class="text-success">JWT Protected</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0"> Available Modules</h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <ul class="list-unstyled">
                                                <li> File Integrity Verification</li>
                                                <li> Logs and Notes System</li>
                                                <li> Auto Integrity Monitoring</li>
                                                <li> User Management</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <ul class="list-unstyled">
                                                <li> Hex Viewer Tools</li>
                                                <li> Case Management API</li>
                                                <li> Deep Scan Capabilities</li>
                                                <li> Report Generation</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('systemStatusContent').innerHTML = statusHtml;
            } catch (error) {
                document.getElementById('systemStatusContent').innerHTML = `
                    <div class="alert alert-danger">
                        <h6> Error Loading System Status</h6>
                        <p>Unable to fetch system information. Please check your connection.</p>
                    </div>
                `;
            }
        }

        async function refreshSystemStatus() {
            document.getElementById('systemStatusContent').innerHTML = `
                <div class="text-center">
                    <div class="spinner-border" role="status"></div>
                    <p class="mt-2">Refreshing system status...</p>
                </div>
            `;
            await loadSystemStatus();
        }

        // Load dashboard statistics
        async function loadDashboardStats() {
            try {
                // Load cases count
                const casesResponse = await fetch('/api/forensic/cases', {
                    headers: { 'Authorization': `Bearer ${authManager.getToken()}` }
                });
                if (casesResponse.ok) {
                    const cases = await casesResponse.json();
                    document.getElementById('total-cases').textContent = cases.length;
                }
                
                // You can add more stat loading here for other metrics
                // For now, we'll use placeholder values that increment over time
                const recoveredFiles = Math.floor(Math.random() * 50) + 10;
                const imagesAnalyzed = Math.floor(Math.random() * 30) + 5;
                
                document.getElementById('recovered-files').textContent = recoveredFiles;
                document.getElementById('images-analyzed').textContent = imagesAnalyzed;
                
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
            }
        }

        // Override fetch functions to include authentication
        const originalFetch = window.fetch;
        window.fetch = async function (url, options = {}) {
            // Only modify API calls
            if (url.startsWith('/api/') && authManager) {
                const token = authManager.getToken();
                if (token) {
                    options.headers = {
                        ...options.headers,
                        'Authorization': `Bearer ${token}`
                    };
                }
            }
            return originalFetch(url, options);
        };

        // Create floating particles
        function createParticles() {
            const container = document.getElementById('particles-container');
            if (!container) return;

            const particleCount = 20;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + 'vw';
                particle.style.animationDelay = Math.random() * 8 + 's';
                particle.style.animationDuration = (8 + Math.random() * 4) + 's';
                container.appendChild(particle);
            }
        }

        // Apply premium styling on page load
        document.addEventListener('DOMContentLoaded', function () {
            createParticles();

            // Apply premium classes to cards
            document.querySelectorAll('.card').forEach((card, index) => {
                card.classList.add('premium-card', 'fade-in-up', `animate-delay-${(index % 5) + 1}`);
            });

            // Apply premium classes to buttons
            document.querySelectorAll('.btn').forEach(btn => {
                if (!btn.classList.contains('btn-outline-danger')) {
                    btn.classList.add('btn-premium');
                }
            });

            // Apply premium classes to progress bars
            document.querySelectorAll('.progress').forEach(progress => {
                progress.classList.add('progress-premium');
            });

            document.querySelectorAll('.progress-bar').forEach(bar => {
                bar.classList.add('progress-bar-premium');
            });

            // Apply premium classes to forms
            document.querySelectorAll('.form-control').forEach(control => {
                control.classList.add('form-control-premium');
            });

            // Apply premium classes to tables
            document.querySelectorAll('.table').forEach(table => {
                table.classList.add('table-premium');
            });

            // Apply premium classes to alerts
            document.querySelectorAll('.alert').forEach(alert => {
                alert.classList.add('alert-premium');
            });
        });
    </script>
</body>

</html>